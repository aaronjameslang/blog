<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>CloudFront Invalidation - a&hairsp;j&hairsp;la.ng | blog</title> <link rel="shortcut icon" href="/blog/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/blog/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/blog/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/blog/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>CloudFront Invalidation | a&amp;hairsp;j&amp;hairsp;la.ng blog</title> <meta name="generator" content="Jekyll v4.2.1" /> <meta property="og:title" content="CloudFront Invalidation" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." /> <meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." /> <link rel="canonical" href="/blog/cloudfront-invalidation.html" /> <meta property="og:url" content="/blog/cloudfront-invalidation.html" /> <meta property="og:site_name" content="a&amp;hairsp;j&amp;hairsp;la.ng blog" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="CloudFront Invalidation" /> <script type="application/ld+json"> {"description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","@type":"WebPage","url":"/blog/cloudfront-invalidation.html","headline":"CloudFront Invalidation","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/blog/" class="site-title lh-tight"> a&hairsp;j&hairsp;la.ng | blog </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="/blog/cloudfront-invalidation.html" class="nav-list-link active">CloudFront Invalidation</a></li><li class="nav-list-item"><a href="/blog/explicit-versioning.html" class="nav-list-link">Explicit Versioning</a></li><li class="nav-list-item"><a href="/blog/exponential-linear-intersection/" class="nav-list-link">Exponential Linear Intersection</a></li><li class="nav-list-item"><a href="/blog/headless-raspberry-pi.html" class="nav-list-link">Headless Raspberry Pi</a></li><li class="nav-list-item"><a href="/blog/outbound-link-warnings.html" class="nav-list-link">Outbound Link Warnings</a></li><li class="nav-list-item"><a href="/blog/student-loan-calculator/" class="nav-list-link">Student Loan Calculator</a></li><li class="nav-list-item"><a href="/blog/uk-house-prices/" class="nav-list-link">UK House Prices</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search a&hairsp;j&hairsp;la.ng | blog" aria-label="Search a&hairsp;j&hairsp;la.ng | blog" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 id="cloudfront-invalidation"> <a href="#cloudfront-invalidation" class="anchor-heading" aria-labelledby="cloudfront-invalidation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CloudFront Invalidation </h1> <p>Hosting sites serverlessly using AWS S3 and CloudFront is a simple and affordable solution. Deploys can be automated simply using the <a href="https://www.serverless.com/">serverless</a> framework and the <a href="https://www.serverless.com/plugins/serverless-s3-sync">S3 sync</a> plugin.</p> <p>Once you’ve synced your files up to your S3 bucket, you can use the below script to clear your CloudFront cache. Automating this as part of your deploy process will save confusion when your client can’t see your updates.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">AWS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">aws-sdk</span><span class="dl">'</span><span class="p">)</span>

<span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">DistributionId</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">AWS_DISTRIBUTION_ID</span><span class="p">,</span>
  <span class="na">InvalidationBatch</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">CallerReference</span><span class="p">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span>
    <span class="na">Paths</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">Quantity</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="na">Items</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">/*</span><span class="dl">'</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">new</span> <span class="nx">AWS</span><span class="p">.</span><span class="nx">CloudFront</span><span class="p">({</span> <span class="na">apiVersion</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2020-05-31</span><span class="dl">'</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">createInvalidation</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">stack</span><span class="p">)</span>
      <span class="k">throw</span> <span class="nx">err</span>
    <span class="p">}</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Invalidation complete</span><span class="dl">'</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
  <span class="p">})</span>
</code></pre></div></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
